<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <!-- JQuery -->
    <script type="text/javascript" src="../../dependencies/jquery/jquery.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery-ui.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery.websocket.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery.json.js"></script>
    <!-- ****** -->

    <!-- Other scripts -->
    <script type="text/javascript" src="../../Flashphoner.js"></script>
    <script type="text/javascript" src="../../dependencies/swf/swfobject.js"></script>

    <script type="text/javascript" src="SoundControl.js"></script>
    <script type="text/javascript" src="listener/DefaultListener.js"></script>
    <script type="text/javascript" src="listener/LoadToolListener.js"></script>
    <script type="text/javascript" src="../ConfigurationLoader.js"></script>
    <script type="text/javascript" src="Phone.js"></script>
    <script type="application/javascript">

        var phone = new Phone();

        ConfigurationLoader.getInstance(function () {
            trace("Configuration loaded");

            Flashphoner.getInstance().init(getElement('localVideoPreview'), getElement('remoteVideo'), "../../dependencies/flash/MediaManager.swf");

            phone.init();

            $("#logoutButton").click(function () {
                phone.disconnect();
            });

            $("#loginButton").click(function () {
                phone.connect();
            });

            $("#callButton").click(function () {
                phone.call($("#calleeText").val());
            });

            $("#transferButton").click(function () {
                if (phone.currentCall) {
                    phone.transfer(phone.currentCall.callId, $("#transferInput").val());
                }
            });

            $("#answerButton").click(function () {
                if (phone.currentCall) {
                    phone.answer(phone.currentCall);
                }
            });

            $("#holdButton").click(function () {
                if (phone.currentCall) {
                    phone.hold(phone.currentCall);
                }
            });

            $("#unholdButton").click(function () {
                if (phone.currentCall) {
                    phone.unhold(phone.currentCall);
                }
            });


            $("#hangupButton").click(function () {
                if (phone.currentCall) {
                    phone.hangup(phone.currentCall);
                }
            });

            $("#messageButton").click(function () {
                var message = new Message();
                message.to = $("#messageToInput").val();
                message.body = $("#messageBodyInput").val();

                phone.sendMessage(message);
            });

            $("#bugReportButton").click(function () {
                phone.submitBugReport();
            });

            $("#chatButton").click(function () {
            });

            $('#username').keyup(function () {
                $('#authname').val($(this).val());
            });

            $('#domain').keyup(function () {
                $('#outbound_proxy').val($(this).val());
            });

            $("#micSlider").slider({
                orientation: "vertical",
                range: "min",
                min: 0,
                max: 100,
                value: 60,
                slide: function (event, ui) {
                    Flashphoner.getInstance().setMicVolume(ui.value);
                }
            });

            $("#speakerSlider").slider({
                orientation: "vertical",
                range: "min",
                min: 0,
                max: 100,
                value: 60,
                slide: function (event, ui) {
                    Flashphoner.getInstance().setVolume(ui.value);
                }
            });

            $('#speakerSlider').show();
            $('#speakerBack').show();
        });

    </script>

    <!-- ************* -->
    <title>Phone</title>
</head>
<body>
<!-- Video + RequestUnmuted view -->
<div id="video_requestUnmuteDiv" style="border: 1px double black;padding: 10px">
    <div id="webrtcVideoDiv" style="float:left;">
        <video id="remoteVideo" autoplay style="background-color: #000000; width:640px; height:480px;"></video>
        <video id="localVideoPreview" autoplay class="ui-widget-content"
               style="background-color: #000000; width: 160px; height: 120px;"></video>
    </div>
    <div style="border: 1px double black;padding: 10px;float:left;">
        <div id="flashVideoDiv">

        </div>
    </div>
</div>
<!-- *************************** -->

<!-- Login view -->
<div id="loginDiv" style="border: 1px double black;padding: 10px; clear: both">
    <label for="username">Login</label><input type="text" id="username" value="1000"/>
    <label for="authname">Auth. name</label><input type="text" id="authname" value="1000"/>
    <label for="password">Password</label><input id="password" type="password" value="1234"/>
    <label for="domain">Domain</label><input type="text" id="domain" value="87.226.225.52"/>
    <label for="outbound_proxy">Outbound proxy</label><input type="text" id="outbound_proxy" value="87.226.225.52"/>
    <label for="port">Port</label><input type="text" id="port" value="5080"/>

    <input id="loginButton" type="button" value="Log in"/>
    <input id="logoutButton" type="button" value="Log out"/>
</div>
<!-- ************* -->

<!-- JS phone -->
<div id="phoneDiv" style="border: 1px double black;padding: 10px">

    <label for="checkboxUseWebRTC">Use WebRTC</label><input id="checkboxUseWebRTC" type="checkbox"/>

    <input id="calleeText" value=""/>

    <label for="checkboxVideoCall">Video Call</label><input id="checkboxVideoCall" type="checkbox"/>

    <input type="button" id="callButton" value="Call"/>

    <input type="button" id="answerButton" value="Answer"/>
    <input type="button" id="hangupButton" value="Hangup"/>

</div>
<!-- *********** -->

<!-- Transfer view -->
<div style="border: 1px double black;padding: 10px">
    <input id="holdButton" type="button" value="Hold"/>
    <input id="unholdButton" type="button" value="Unhold"/>
    <input id="transferInput" type="text"/>
    <input id="transferOk" type="button" value="Transfer"/>
</div>
<!-- ************* -->

<!-- Message view -->
<div style="border: 1px double black;padding: 10px">
    <label for="messageToInput">Message to</label><input id="messageToInput" type="text"/>
    <label for="messageBodyInput">Body</label><input id="messageBodyInput" type="text"/>
    <input id="messageButton" type="button" value="Send"/>
</div>
<!-- ************* -->

<div id="console"
     style="height: 450px; width: 100%;background-color: #333;color: #eee; padding: 10px; overflow: auto; word-wrap: break-word;">

</div>

<!-- Console -->
<div id="bugReport" style="border: 1px double black;padding: 10px">
    <textarea id="bugReportText" cols="50" rows="10"></textarea>
    <input id="bugReportButton" type="button" value="Submit Bug Report"/>
</div>
<!-- ******* -->
</body>
</html>
