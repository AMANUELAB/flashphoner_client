<!DOCTYPE html>
<html>
<head>
    <title></title>

    <!-- JQuery -->
    <script type="text/javascript" src="../../dependencies/jquery/jquery.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery-ui.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery.websocket.js"></script>
    <script type="text/javascript" src="../../dependencies/jquery/jquery.json.js"></script>

    <script>


        function sendNotificationAboutStream(operationId, payload, nodeId, sessionId, serverRestUrl){
            var data = JSON.stringify({operationId: operationId, payload:payload, nodeId: nodeId, sessionId: sessionId});
            $.ajax({
                type: "POST",
                url: serverRestUrl,
                data: data,
                success: function(){
                    trace("sendNotificationAboutStream - SENT");
                },
                processData: false,
                dataType: "jsonp",
                contentType : "application/json"
            });
        }

        function streamChanged(operationId){

            var restUrl = element("restUrl");

            var nodeId = element("nodeId");
            var sessionId = element("sessionId");
            var publisher = element("publisher");
            var streamName = element("streamName");

            var operationId = operationId;;
            var payload = {stream:streamName, publisher: publisher};

            //Send notification to WCS server. WCS will forward this notification to User with these (sessionId and nodeId) connected via Websocket
            sendNotificationAboutStream(operationId, payload, nodeId, sessionId, restUrl)
        }

        function element(elementId){
            return document.getElementById(elementId).value;
        }

        function setURL() {
            document.getElementById("urlServer").value = "http://" + window.location.hostname +":9091/RESTCallback/sendData";
        }


    </script>
</head>
<body onload="setURL()">
       <h1>Conference Server Callback Emulator</h1>
       <p>Server REST URL&nbsp;&nbsp;&nbsp;<input id="restUrl" size="50" type="text" value=""/></p>
       <br/>
       <p>NodeId&nbsp;&nbsp;&nbsp;<input id="nodeId" size="50" type="text" value="nodeId"/></p>
       <p>SessionId&nbsp;&nbsp;&nbsp;<input id="sessionId" size="50" type="text" value="sessionId"/></p>
       <p>Publisher&nbsp;&nbsp;&nbsp;<input id="publisher" size="50" type="text" value="publisher"/></p>
       <p>StreamName&nbsp;&nbsp;&nbsp;<input id="streamName" size="50" type="text" value="streamName"/></p>
       <p><input type="button" value="Stream published by user" onclick="streamChanged('streamPublishedByUser')"/><p>
       <p><input type="button" value="Stream unpublished by user" onclick="streamChanged('streamUnpublishedByUser')"/><p>
</body>
</html>